# Шаблон проекта с использованием CMakeLists/Makefile

**Этот репозиторий посвящён CMake и make**
- Объяснены базовые вещи
- Приведены примитивные шаблоны для использования
- Приведена заготовка для проекта

## Структура репозитория

``
my-project/                      # каталог проекта
  ├── src/                       # каталог исходных файлов проекта
  │     └── main.c             # исходный файл (пока только *.c файл)
  └── CMakeLists.txt             # конфигурационный файл системы CMake
Examples/                        # каталог примеров
  ├── cmakefiles.txt             # пример файла CMakeLists.txt
  └── makefile                   # пример Makefile
Samples/                         # каталог шаблонов
  ├── CMakeLists_complex.txt     # шаблон сложного CMakeLists.txt
  ├── makefile_complex           # шаблон Makefile для сложного проекта
  ├── CMakeLists_simple.txt      # шаблон простого CMakeLists.txt
  └── makefile_simple            # шаблон Makefile для простого проекта
``
## Используем Makefile
### Описание шаблона makefile

Нижеприведённый Makefile представляет простой шаблон с правилами компиляции, очистки и запуска проекта. Он состоит из следующих элементов:
1. `TARGET = ./main.exe`: Здесь определяется переменная TARGET, которая содержит путь и имя целевого исполняемого файла.
2. `.PHONY: all, build, clean, run`: Эта строка объявляет цели all, build, clean и run как фиктивные (PHONY), что означает, что они не являются реальными файлами.
3. `${TARGET}`: ...: Это правило для компиляции целевого файла `${TARGET}`. Оно использует компилятор gcc для компиляции исходного файла __main.c__, указывая пути к заголовочным файлам `(-I path\to\include\files)` и библиотекам `(-L path\to\libs)`. Результат компиляции сохраняется в указанном файле `${TARGET}`.
4. `all: clean build`: Цель `all` объединяет выполнение целей `clean` и `build`. При вызове make `all` сначала будет выполнена цель `clean`, а затем `build`.
5. `build: ${TARGET}`: Цель `build` зависит от цели `${TARGET}`. При вызове make `build` будет выполнено правило компиляции целевого файла.
6. `clean`: Цель clean удаляет целевой исполняемый файл `${TARGET}` с помощью команды `rm -rf`.
7. `run`: Цель run запускает целевой исполняемый файл `${TARGET}`.

Этот Makefile обеспечивает простую структуру сборки проекта, позволяя компилировать и запускать ваш код с минимальными усилиями. Вы можете использовать его в своих проектах, изменяя пути, имена файлов и другие параметры по своему усмотрению.

### Шаблон makefile
```makefile
TARGET = ./main.exe
.PHONY: all, build, clean, run
${TARGET}:
	gcc -I path\to\include\files -L path\to\libs hello.c -lmylib -o ${TARGET}
all: clean build
build: ${TARGET}
clean:
	rm -rf ${TARGET}
run:
	${TARGET}
```
### Сборка проекта с makefile
__Для сборки проекта, следуйте этим шагам:__

1. Перейдите в каталог с файлом __makefile__.
2. Выполните команду `make` для обработки __makefile__ и сборки проекта.
    * команда `make clean` удалит результат сборки
    * команла `make run` запустит _.exe файл_

## Используем Cmake
### Описание шаблона CMakeLists

Итак, мы начали простой проект. Создали каталог `my-project` и создали в нем подкаталог `src` для размещения источников кода нашего проекта. Напишем заготовку в файл `src/main.cpp` и теперь настроим CMake для сборки по этому проекту. Потом мы будем добавлять в сборку новые файлы и, возможно, библиотеки. Отразим все эти возможности в нашей заготовке.

Конфигурационный файл для системы CMake должен называться `CMakeLists.txt`. Расположим его в каталоге `my-project` и получим следующую систему файлов.

Представим шаблон файла `CMakeLists.txt` для простого проекта.

### Шаблон файла CMakeLists.txt

```Cmake
# Выставляет требование по минимальной версии CMake
cmake_minimum_required(VERSION <version>)   

# Задает имя проекта и устанавливает переменные <project_name>_BINARY_DIR и <project_name>_SOURCE_DIR
project(<project_name>)                      

# Создает переменную SRC_DIR с путем к каталогу src
set(SRC_DIR ${PROJECT_SOURCE_DIR}/src)       

# Добавляет указанные каталоги к списку каталогов поиска заголовочных файлов
include_directories(<dir1> <dir2> ...)       

# Добавляет указанные каталоги к списку каталогов поиска библиотек для линковки
link_directories(<dir1> <dir2> ...)         

# Добавляет файл main.c к списку исходных файлов
list(APPEND SRC ${SRC_DIR}/main.c)        

# Создает исполняемый файл, используя список исходных файлов
add_executable(<executable_name> ${SRC})     

# Задает библиотеки для линковки с исполняемым файлом
target_link_libraries(<executable_name> <library1> <library2> ...)   
```

### Сборка проекта с Cmake
__Для сборки проекта, следуйте этим шагам:__

1. Перейдите в каталог с файлом __CMakeLists.txt__.
2. Выполните команду `cmake .` (не забудьте точку в конце).
3. Будет создан __Makefile__.
4. Выполните команду `make` для обработки __Makefile__ и сборки проекта.
